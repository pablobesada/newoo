<template name="transactions_report">
    <form class="js-transactions_report-form form-inline" role="form">
        <div class="input-daterange input-group" id="datepicker">
            <input type="text" class="input-sm form-control" name="start" value="{{start}}"/>
            <span class="input-group-addon">to</span>
            <input type="text" class="input-sm form-control" name="end" value="{{end}}"/>
        </div>
        <input type="text" class="input-sm form-control" name="apartment" value="{{cur_apartment}}"/>
        <input type="submit"/>
    </form>
    <div class="container">
        {{#if Template.subscriptionsReady }}
            <div class="row">
                <div class="col-xs-4 col-sm-3 col-md-2 col-lg-1 js-apartment apartment" apartment_code=""
                     is_current_apartment="{{isCurrentApartment ''}}">
                    Movimientos
                </div>
                {{#each ap in get_apartments}}
                    <div class="col-xs-4 col-sm-3 col-md-2 col-lg-1 js-apartment apartment" apartment_code="{{ap.code}}"
                         is_current_apartment="{{isCurrentApartment ap.code}}">
                        {{ap.code}}
                    </div>
                {{/each}}
            </div>
        {{/if}}
    </div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th></th>
            {{#each user in users}}
                <th class="text-right">{{user}}</th>
            {{/each}}
            <th class="text-right">Total</th>
        </tr>
        </thead>
        {{#each currency in currencies}}
            <tr>
                <th>{{currency}}</th>
                {{#each user in users}}
                    <td class="text-right">{{get_amount user currency}}</td>
                {{/each}}
                <td class="text-right">{{get_total currency}}</td>
            </tr>
        {{/each}}
    </table>
    <a class="js-new-transaction">Nuevo</a>
    <div class="panel">
        <table class="table table-striped table-hover listview_header">
            <thead>
            <tr>
                <th>Numero</th>
                <th>Fecha</th>
                <th>Depto</th>
                <th class="text-right">ARS</th>
                <th class="text-right">USD</th>
                <th>Usuario</th>
                <th>Descripci√≥n</th>
            </tr>
            </thead>
        </table>
        <div class="listview_content" style="height: 350px">
            <table class="table table-striped table-hover">
                <tbody>
                {{#each trans in transactions}}
                    {{#with trans}}
                        <tr class="js-record-row">
                            <td>{{trans.number}}</td>
                            <td>{{trans.date}}</td>
                            <td>{{trans.apartment}}</td>
                            {{#if isARS trans.currency}}
                                <td class="text-right">{{trans.amount}}</td>
                                <td></td>
                            {{else}}
                                <td></td>
                                <td class="text-right">{{trans.amount}}</td>
                            {{/if}}
                            <td>{{trans.user}}</td>
                            <td>{{trans.description}}</td>
                        </tr>
                    {{/with}}
                {{/each}}
                </tbody>
            </table>
        </div>
    </div>
    <hr>
    {{> Transactions_view record_variable=cur_record}}

</template>